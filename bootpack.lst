     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_init_gdtidt
     7 00000000                                 	EXTERN	_init_pic
     8 00000000                                 	EXTERN	_io_sti
     9 00000000                                 	EXTERN	_keyfifo
    10 00000000                                 	EXTERN	_fifo8_init
    11 00000000                                 	EXTERN	_mousefifo
    12 00000000                                 	EXTERN	_io_out8
    13 00000000                                 	EXTERN	_init_palette
    14 00000000                                 	EXTERN	_init_screen8
    15 00000000                                 	EXTERN	_init_mouse_cursor8
    16 00000000                                 	EXTERN	_putblock8_8
    17 00000000                                 	EXTERN	_sprintf
    18 00000000                                 	EXTERN	_putfonts8_asc
    19 00000000                                 	EXTERN	_io_cli
    20 00000000                                 	EXTERN	_fifo8_status
    21 00000000                                 	EXTERN	_fifo8_get
    22 00000000                                 	EXTERN	_boxfill8
    23 00000000                                 	EXTERN	_io_stihlt
    24 00000000                                 	EXTERN	_io_in8
    25 00000000                                 [FILE "bootpack.c"]
    26                                          [SECTION .data]
    27 00000000                                 LC0:
    28 00000000 28 25 64 2C 20 25 64 29 00      	DB	"(%d, %d)",0x00
    29 00000009                                 LC1:
    30 00000009 25 30 32 58 00                  	DB	"%02X",0x00
    31                                          [SECTION .text]
    32 00000000                                 	GLOBAL	_HariMain
    33 00000000                                 _HariMain:
    34 00000000 55                              	PUSH	EBP
    35 00000001 89 E5                           	MOV	EBP,ESP
    36 00000003 57                              	PUSH	EDI
    37 00000004 56                              	PUSH	ESI
    38 00000005 53                              	PUSH	EBX
    39 00000006 BB 00000002                     	MOV	EBX,2
    40 0000000B 81 EC 000001D0                  	SUB	ESP,464
    41 00000011 E8 [00000000]                   	CALL	_init_gdtidt
    42 00000016 E8 [00000000]                   	CALL	_init_pic
    43 0000001B E8 [00000000]                   	CALL	_io_sti
    44 00000020 8D 85 FFFFFEA4                  	LEA	EAX,DWORD [-348+EBP]
    45 00000026 50                              	PUSH	EAX
    46 00000027 6A 20                           	PUSH	32
    47 00000029 68 [00000000]                   	PUSH	_keyfifo
    48 0000002E E8 [00000000]                   	CALL	_fifo8_init
    49 00000033 8D 85 FFFFFE24                  	LEA	EAX,DWORD [-476+EBP]
    50 00000039 50                              	PUSH	EAX
    51 0000003A 68 00000080                     	PUSH	128
    52 0000003F 68 [00000000]                   	PUSH	_mousefifo
    53 00000044 E8 [00000000]                   	CALL	_fifo8_init
    54 00000049 68 000000F9                     	PUSH	249
    55 0000004E 6A 21                           	PUSH	33
    56 00000050 E8 [00000000]                   	CALL	_io_out8
    57 00000055 83 C4 20                        	ADD	ESP,32
    58 00000058 68 000000EF                     	PUSH	239
    59 0000005D 68 000000A1                     	PUSH	161
    60 00000062 E8 [00000000]                   	CALL	_io_out8
    61 00000067 E8 000001B1                     	CALL	_init_keyboard
    62 0000006C E8 [00000000]                   	CALL	_init_palette
    63 00000071 0F BF 05 00000FF6               	MOVSX	EAX,WORD [4086]
    64 00000078 50                              	PUSH	EAX
    65 00000079 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    66 00000080 50                              	PUSH	EAX
    67 00000081 FF 35 00000FF8                  	PUSH	DWORD [4088]
    68 00000087 E8 [00000000]                   	CALL	_init_screen8
    69 0000008C 8B 15 00000FF4                  	MOV	EDX,DWORD [4084]
    70 00000092 89 D0                           	MOV	EAX,EDX
    71 00000094 66 99                           	CWD
    72 00000096 66 F7 FB                        	IDIV	BX
    73 00000099 0F BF D0                        	MOVSX	EDX,AX
    74 0000009C 8D 7A F8                        	LEA	EDI,DWORD [-8+EDX]
    75 0000009F 66 8B 15 00000FF6               	MOV	DX,WORD [4086]
    76 000000A6 89 D0                           	MOV	EAX,EDX
    77 000000A8 6A 07                           	PUSH	7
    78 000000AA 66 99                           	CWD
    79 000000AC 66 F7 FB                        	IDIV	BX
    80 000000AF 98                              	CWDE
    81 000000B0 8D 9D FFFFFEC4                  	LEA	EBX,DWORD [-316+EBP]
    82 000000B6 53                              	PUSH	EBX
    83 000000B7 8D 70 F8                        	LEA	ESI,DWORD [-8+EAX]
    84 000000BA E8 [00000000]                   	CALL	_init_mouse_cursor8
    85 000000BF 6A 10                           	PUSH	16
    86 000000C1 53                              	PUSH	EBX
    87 000000C2 8D 5D C4                        	LEA	EBX,DWORD [-60+EBP]
    88 000000C5 56                              	PUSH	ESI
    89 000000C6 57                              	PUSH	EDI
    90 000000C7 6A 10                           	PUSH	16
    91 000000C9 6A 10                           	PUSH	16
    92 000000CB 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    93 000000D2 50                              	PUSH	EAX
    94 000000D3 FF 35 00000FF8                  	PUSH	DWORD [4088]
    95 000000D9 E8 [00000000]                   	CALL	_putblock8_8
    96 000000DE 83 C4 3C                        	ADD	ESP,60
    97 000000E1 56                              	PUSH	ESI
    98 000000E2 57                              	PUSH	EDI
    99 000000E3 68 [00000000]                   	PUSH	LC0
   100 000000E8 53                              	PUSH	EBX
   101 000000E9 E8 [00000000]                   	CALL	_sprintf
   102 000000EE 53                              	PUSH	EBX
   103 000000EF 6A 07                           	PUSH	7
   104 000000F1 6A 00                           	PUSH	0
   105 000000F3 6A 00                           	PUSH	0
   106 000000F5 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   107 000000FC 50                              	PUSH	EAX
   108 000000FD FF 35 00000FF8                  	PUSH	DWORD [4088]
   109 00000103 E8 [00000000]                   	CALL	_putfonts8_asc
   110 00000108 83 C4 28                        	ADD	ESP,40
   111 0000010B E8 0000012E                     	CALL	_enable_mouse
   112 00000110                                 L10:
   113 00000110 E8 [00000000]                   	CALL	_io_cli
   114 00000115 68 [00000000]                   	PUSH	_keyfifo
   115 0000011A E8 [00000000]                   	CALL	_fifo8_status
   116 0000011F 68 [00000000]                   	PUSH	_mousefifo
   117 00000124 89 C3                           	MOV	EBX,EAX
   118 00000126 E8 [00000000]                   	CALL	_fifo8_status
   119 0000012B 8D 04 18                        	LEA	EAX,DWORD [EAX+EBX*1]
   120 0000012E 5B                              	POP	EBX
   121 0000012F 5E                              	POP	ESI
   122 00000130 85 C0                           	TEST	EAX,EAX
   123 00000132 0F 84 000000C9                  	JE	L12
   124 00000138 68 [00000000]                   	PUSH	_keyfifo
   125 0000013D E8 [00000000]                   	CALL	_fifo8_status
   126 00000142 59                              	POP	ECX
   127 00000143 85 C0                           	TEST	EAX,EAX
   128 00000145 75 71                           	JNE	L13
   129 00000147 68 [00000000]                   	PUSH	_mousefifo
   130 0000014C E8 [00000000]                   	CALL	_fifo8_status
   131 00000151 5A                              	POP	EDX
   132 00000152 85 C0                           	TEST	EAX,EAX
   133 00000154 74 BA                           	JE	L10
   134 00000156 68 [00000000]                   	PUSH	_mousefifo
   135 0000015B E8 [00000000]                   	CALL	_fifo8_get
   136 00000160 89 C3                           	MOV	EBX,EAX
   137 00000162 E8 [00000000]                   	CALL	_io_sti
   138 00000167 53                              	PUSH	EBX
   139 00000168 8D 5D C4                        	LEA	EBX,DWORD [-60+EBP]
   140 0000016B 68 [00000009]                   	PUSH	LC1
   141 00000170 53                              	PUSH	EBX
   142 00000171 E8 [00000000]                   	CALL	_sprintf
   143 00000176 6A 1F                           	PUSH	31
   144 00000178 6A 2F                           	PUSH	47
   145 0000017A 6A 10                           	PUSH	16
   146 0000017C 6A 20                           	PUSH	32
   147 0000017E 6A 0F                           	PUSH	15
   148 00000180 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   149 00000187 50                              	PUSH	EAX
   150 00000188 FF 35 00000FF8                  	PUSH	DWORD [4088]
   151 0000018E E8 [00000000]                   	CALL	_boxfill8
   152 00000193 83 C4 2C                        	ADD	ESP,44
   153 00000196 53                              	PUSH	EBX
   154 00000197 6A 07                           	PUSH	7
   155 00000199 6A 10                           	PUSH	16
   156 0000019B 6A 20                           	PUSH	32
   157 0000019D                                 L11:
   158 0000019D 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   159 000001A4 50                              	PUSH	EAX
   160 000001A5 FF 35 00000FF8                  	PUSH	DWORD [4088]
   161 000001AB E8 [00000000]                   	CALL	_putfonts8_asc
   162 000001B0 83 C4 18                        	ADD	ESP,24
   163 000001B3 E9 FFFFFF58                     	JMP	L10
   164 000001B8                                 L13:
   165 000001B8 68 [00000000]                   	PUSH	_keyfifo
   166 000001BD E8 [00000000]                   	CALL	_fifo8_get
   167 000001C2 89 C3                           	MOV	EBX,EAX
   168 000001C4 E8 [00000000]                   	CALL	_io_sti
   169 000001C9 53                              	PUSH	EBX
   170 000001CA 8D 5D C4                        	LEA	EBX,DWORD [-60+EBP]
   171 000001CD 68 [00000009]                   	PUSH	LC1
   172 000001D2 53                              	PUSH	EBX
   173 000001D3 E8 [00000000]                   	CALL	_sprintf
   174 000001D8 6A 1F                           	PUSH	31
   175 000001DA 6A 0F                           	PUSH	15
   176 000001DC 6A 10                           	PUSH	16
   177 000001DE 6A 00                           	PUSH	0
   178 000001E0 6A 0F                           	PUSH	15
   179 000001E2 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
   180 000001E9 50                              	PUSH	EAX
   181 000001EA FF 35 00000FF8                  	PUSH	DWORD [4088]
   182 000001F0 E8 [00000000]                   	CALL	_boxfill8
   183 000001F5 83 C4 2C                        	ADD	ESP,44
   184 000001F8 53                              	PUSH	EBX
   185 000001F9 6A 07                           	PUSH	7
   186 000001FB 6A 10                           	PUSH	16
   187 000001FD 6A 00                           	PUSH	0
   188 000001FF EB 9C                           	JMP	L11
   189 00000201                                 L12:
   190 00000201 E8 [00000000]                   	CALL	_io_stihlt
   191 00000206 E9 FFFFFF05                     	JMP	L10
   192 0000020B                                 	GLOBAL	_wait_KBC_sendready
   193 0000020B                                 _wait_KBC_sendready:
   194 0000020B 55                              	PUSH	EBP
   195 0000020C 89 E5                           	MOV	EBP,ESP
   196 0000020E                                 L19:
   197 0000020E 6A 64                           	PUSH	100
   198 00000210 E8 [00000000]                   	CALL	_io_in8
   199 00000215 5A                              	POP	EDX
   200 00000216 83 E0 02                        	AND	EAX,2
   201 00000219 75 F3                           	JNE	L19
   202 0000021B C9                              	LEAVE
   203 0000021C C3                              	RET
   204 0000021D                                 	GLOBAL	_init_keyboard
   205 0000021D                                 _init_keyboard:
   206 0000021D 55                              	PUSH	EBP
   207 0000021E 89 E5                           	MOV	EBP,ESP
   208 00000220 E8 FFFFFFE6                     	CALL	_wait_KBC_sendready
   209 00000225 6A 60                           	PUSH	96
   210 00000227 6A 64                           	PUSH	100
   211 00000229 E8 [00000000]                   	CALL	_io_out8
   212 0000022E E8 FFFFFFD8                     	CALL	_wait_KBC_sendready
   213 00000233 6A 47                           	PUSH	71
   214 00000235 6A 60                           	PUSH	96
   215 00000237 E8 [00000000]                   	CALL	_io_out8
   216 0000023C C9                              	LEAVE
   217 0000023D C3                              	RET
   218 0000023E                                 	GLOBAL	_enable_mouse
   219 0000023E                                 _enable_mouse:
   220 0000023E 55                              	PUSH	EBP
   221 0000023F 89 E5                           	MOV	EBP,ESP
   222 00000241 E8 FFFFFFC5                     	CALL	_wait_KBC_sendready
   223 00000246 68 000000D4                     	PUSH	212
   224 0000024B 6A 64                           	PUSH	100
   225 0000024D E8 [00000000]                   	CALL	_io_out8
   226 00000252 E8 FFFFFFB4                     	CALL	_wait_KBC_sendready
   227 00000257 68 000000F4                     	PUSH	244
   228 0000025C 6A 60                           	PUSH	96
   229 0000025E E8 [00000000]                   	CALL	_io_out8
   230 00000263 C9                              	LEAVE
   231 00000264 C3                              	RET
